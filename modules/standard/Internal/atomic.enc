module Internal

typedef AtomicQ = EMBED void * END

local class AtomicWrapper[active t]
  val queue : AtomicQ
  val target : t
  def init(target : t) : unit
    this.target = target
    this.queue = create_atomic_queue()
    target ! atomic(queue)
  where
    fun create_atomic_queue() : AtomicQ
      null
    end
  end
end
